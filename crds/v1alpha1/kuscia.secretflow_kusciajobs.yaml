---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.9.2
  creationTimestamp: null
  name: kusciajobs.kuscia.secretflow
spec:
  group: kuscia.secretflow
  names:
    kind: KusciaJob
    listKind: KusciaJobList
    plural: kusciajobs
    shortNames:
    - kj
    singular: kusciajob
  scope: Cluster
  versions:
  - additionalPrinterColumns:
    - jsonPath: .status.startTime
      name: StartTime
      type: date
    - jsonPath: .status.completionTime
      name: CompletionTime
      type: date
    - jsonPath: .status.lastReconcileTime
      name: LastReconcileTime
      type: date
    - jsonPath: .status.phase
      name: Phase
      type: string
    name: v1alpha1
    schema:
      openAPIV3Schema:
        description: KusciaJob is the Schema for the kuscia job API.
        properties:
          apiVersion:
            description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
            type: string
          kind:
            description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
            type: string
          metadata:
            type: object
          spec:
            description: KusciaJobSpec defines the information of kuscia job spec.
            properties:
              initiator:
                description: Initiator who submit this KusciaJob.
                type: string
              maxParallelism:
                default: 1
                description: MaxParallelism max parallelism of tasks, default 1. At
                  a certain moment, there may be multiple subtasks that can be scheduled.
                  this field defines the maximum number of tasks in the Running state.
                maximum: 128
                minimum: 1
                type: integer
              scheduleMode:
                description: ScheduleMode defines how this job will be scheduled.
                  In Strict, if any non-tolerable subtasks failed, Scheduling for
                  this task stops immediately, and it immediately enters the final
                  Failed state. In BestEffort, if any non-tolerable subtasks failed,
                  Scheduling for this job will continue. But the successor subtask
                  of the failed subtask stops scheduling, and the current state will
                  be running. When all subtasks succeed or fail, the job will enter
                  the Failed state.
                enum:
                - Strict
                - BestEffort
                type: string
              tasks:
                description: Tasks defines the subtasks participating in scheduling
                  and their dependencies, and the subtasks and dependencies should
                  constitute a directed acyclic graph. During runtime, each subtask
                  will be created as a KusciaTask.
                items:
                  properties:
                    appImage:
                      description: AppImage defines image be used in KusciaTask
                      type: string
                    dependencies:
                      description: Dependencies defines the dependencies of this subtask.
                        Only when the dependencies of this subtask are all in the
                        Succeeded state, this subtask can be scheduled.
                      items:
                        type: string
                      maxItems: 128
                      minItems: 1
                      type: array
                    parties:
                      description: Parties defines participants and role in this KusciaTask
                      items:
                        properties:
                          domainID:
                            type: string
                          role:
                            type: string
                        required:
                        - domainID
                        type: object
                      type: array
                    priority:
                      description: Priority defines priority of ready subtask. When
                        multiple subtasks are ready, which one is scheduled first.
                        The larger the value of this field, the higher the priority.
                      maximum: 128
                      minimum: 1
                      type: integer
                    scheduleConfig:
                      description: ScheduleConfig defines the schedule config for
                        KusciaTask.
                      properties:
                        lifecycleSeconds:
                          type: integer
                        minReservedMembers:
                          minimum: 1
                          type: integer
                        resourceReservedSeconds:
                          type: integer
                        retryIntervalSeconds:
                          type: integer
                      type: object
                    taskID:
                      description: TaskID will be used as KusciaTask resource name,
                        so it should match rfc1123 DNS_LABEL pattern. It will be used
                        in Dependencies.
                      pattern: '[a-z0-9]([-a-z0-9]*[a-z0-9])?'
                      type: string
                    taskInputConfig:
                      description: TaskInputConfig defines input config for KusciaTask.
                      type: string
                    tolerable:
                      default: false
                      description: Tolerable default false. If this sub-task failed,
                        job will not be failed. tolerable sub-task can not be other
                        sub-tasks dependencies.
                      type: boolean
                  required:
                  - appImage
                  - parties
                  - priority
                  - taskID
                  - taskInputConfig
                  type: object
                maxItems: 128
                minItems: 1
                type: array
            required:
            - initiator
            - scheduleMode
            - tasks
            type: object
          status:
            description: KusciaJobStatus defines the observed state of kuscia job.
            properties:
              completionTime:
                description: Represents time when the job was completed. It is not
                  guaranteed to be set in happens-before order across separate operations.
                  It is represented in RFC3339 form and is in UTC.
                format: date-time
                type: string
              lastReconcileTime:
                description: Represents last time when the job was reconciled. It
                  is not guaranteed to be set in happens-before order across separate
                  operations. It is represented in RFC3339 form and is in UTC.
                format: date-time
                type: string
              message:
                description: A human-readable message indicating details about why
                  the job is in this condition.
                type: string
              phase:
                description: The phase of a KusciaJob is a simple, high-level summary
                  of where the job is in its lifecycle.
                type: string
              reason:
                description: A brief CamelCase message indicating details about why
                  the job is in this state.
                type: string
              startTime:
                description: Represents time when the job was acknowledged by the
                  job controller. It is not guaranteed to be set in happens-before
                  order across separate operations. It is represented in RFC3339 form
                  and is in UTC.
                format: date-time
                type: string
              taskStatus:
                additionalProperties:
                  description: KusciaTaskPhase is a label for the condition of a kuscia
                    task at the current time.
                  type: string
                description: TaskStatus describes subtasks state. The key is taskId.
                  Uncreated subtasks will not appear here.
                type: object
            type: object
        required:
        - metadata
        - spec
        type: object
    served: true
    storage: true
    subresources:
      status: {}
